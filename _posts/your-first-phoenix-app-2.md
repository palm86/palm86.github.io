---
layout: post
title: Your first Phoenix app <span>#2</span>
published: false
---

This post begins where [Part 1](https://palm86.github.io/2016/10/04/your-first-phoenix-app-1/) left off. Weâ€™ll setup the database, create a model, and take a look at how to get something like Django's automatically-generated admin site in Phoenix.

## Database setup

We have actually already created the database. You will remember the call to `mix ecto.create`. You may have guessed that Ecto is a database library for Elixir. It is akin to Django's ORM, but unlike Django's ORM it is not a built-in part of Phoenix and of course it is not really an ORM because we are not dealing with objects. The database was created according to the settings in `mysite/config/dev.exs`, which in turn were generated by the `mix phoenix.new` command. This section in particular specifies the database engine, credentials, name and other options:

{% highlight elixir %}

# Configure your database
config :mysite, Mysite.Repo,
  adapter: Ecto.Adapters.Postgres,
  username: "postgres",
  password: "postgres",
  database: "mysite_dev",
  hostname: "localhost",
  pool_size: 10
{% endhighlight %}

The default settings assumes you will use a PostgreSQL database, but Ecto also officially supports MySQL via the `Ecto.Adapters.MySQL` adapter.

At this point the database is still empty because we have not created any models yet. Had we been using Django, we would already have had a `User` model as well as some models used for authentication and session handling. We will add these as the need arises.

## Creating models

A model is essentially the schema and metadata for a database table. Django subscribes to the fat model philosophy that states the the model is the single definitive source of information about a database entity. This philosophy is grounded in the DRY principle. While Elixir and Phoenix are also advocates of the DRY principle, models in Phoenix are closer to just being a schema with some validation and query transformation functions. Nothing prevents you from concentrating your business logic in your models, but the trend seems to be leaning in the direction of controllers or some specialized service modules. Phoenix 1.3 will even rename 'model' to 'schema'.

Be that as it may, we will create two models: `Mysite.Question` and `Mysite.Choice` Create and edit `mysite/web/models/question.ex` and `mysite/web/models/choice.ex` to look like this:

{% highlight elixir %}
#mysite/web/models/question.ex

defmodule Mysite.Question do
  use Ecto.Schema

  schema "question" do
    field :question_text, :string
    field :published_at, :datetime

    has_many :choices, Mysite.Choice
  end
end

#mysite/web/models/choice.ex

defmodule Mysite.Choice do
  use Ecto.Schema

  schema "choice" do
    belongs_to :question, Mysite.Question, on_delete: :delete_all

    field :choice_text, :string
    field :votes, :integer, default: 0
  end
end
{% endhighlight %}
